<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Weather - Real-Time Worldwide Forecast</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: white;
            text-align: center;
            font-size: 3em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .search-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .search-box {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            font-size: 16px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            backdrop-filter: blur(5px);
        }

        .search-box::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .search-box:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.6);
            background: rgba(255, 255, 255, 0.25);
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.3);
            color: white;
            transition: all 0.3s;
            backdrop-filter: blur(5px);
        }

        .btn:hover {
            background: rgba(255, 255, 255, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .settings-bar {
            display: flex;
            gap: 10px;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
        }

        .toggle-btn {
            padding: 10px 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            transition: all 0.3s;
        }

        .toggle-btn.active {
            background: rgba(255, 255, 255, 0.4);
            border-color: rgba(255, 255, 255, 0.6);
        }

        .error-message {
            background: rgba(239, 68, 68, 0.3);
            border: 2px solid rgba(239, 68, 68, 0.5);
            color: white;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: none;
        }

        .loading {
            text-align: center;
            padding: 60px;
            color: white;
            font-size: 1.5em;
            display: none;
        }

        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .weather-content {
            display: none;
        }

        .current-weather {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .location-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .location-name {
            font-size: 2.5em;
            color: white;
            font-weight: bold;
        }

        .location-country {
            font-size: 1.2em;
            color: rgba(255, 255, 255, 0.8);
        }

        .current-date {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1em;
            text-align: right;
        }

        .main-temp-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .temp-display {
            font-size: 6em;
            color: white;
            font-weight: bold;
            line-height: 1;
        }

        .temp-unit {
            font-size: 0.4em;
            color: rgba(255, 255, 255, 0.8);
        }

        .weather-description {
            font-size: 1.8em;
            color: white;
            margin-top: 10px;
        }

        .feels-like {
            color: rgba(255, 255, 255, 0.7);
            margin-top: 5px;
            font-size: 1.1em;
        }

        .weather-icon {
            font-size: 8em;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.2));
        }

        .weather-alerts {
            background: rgba(255, 193, 7, 0.3);
            border: 2px solid rgba(255, 193, 7, 0.6);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            display: none;
        }

        .alert-title {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .weather-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .detail-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }

        .detail-card:hover {
            transform: translateY(-3px);
        }

        .detail-label {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .detail-value {
            color: white;
            font-size: 2em;
            font-weight: bold;
        }

        .detail-subvalue {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9em;
            margin-top: 5px;
        }

        .two-column-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .section-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .section-title {
            color: white;
            font-size: 1.8em;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .hourly-scroll {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            padding: 10px 0;
        }

        .hourly-scroll::-webkit-scrollbar {
            height: 8px;
        }

        .hourly-scroll::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .hourly-scroll::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
        }

        .hourly-card {
            min-width: 100px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
        }

        .hourly-time {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .hourly-icon {
            font-size: 2.5em;
            margin: 10px 0;
        }

        .hourly-temp {
            color: white;
            font-weight: bold;
            font-size: 1.2em;
        }

        .air-quality-card {
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            margin-bottom: 15px;
        }

        .aqi-value {
            font-size: 3em;
            color: white;
            font-weight: bold;
            margin: 10px 0;
        }

        .aqi-label {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.1em;
        }

        .forecast-section {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .forecast-title {
            color: white;
            font-size: 1.8em;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .forecast-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
            gap: 15px;
        }

        .forecast-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: transform 0.3s;
        }

        .forecast-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.15);
        }

        .forecast-day {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .forecast-icon {
            font-size: 3em;
            margin: 10px 0;
        }

        .forecast-temp {
            color: white;
            font-weight: bold;
            font-size: 1.3em;
        }

        .forecast-temp-low {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9em;
            margin-top: 5px;
        }

        .forecast-rain {
            color: rgba(135, 206, 250, 0.9);
            font-size: 0.85em;
            margin-top: 5px;
        }

        .uv-index-bar {
            width: 100%;
            height: 10px;
            background: linear-gradient(to right, #289500, #f7e400, #f85900, #d8001d, #6b49c8);
            border-radius: 5px;
            margin-top: 10px;
            position: relative;
        }

        .uv-indicator {
            position: absolute;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            top: -5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .sun-times {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }

        .sun-time-item {
            text-align: center;
        }

        .sun-time-icon {
            font-size: 2em;
            margin-bottom: 5px;
        }

        .sun-time-value {
            color: white;
            font-weight: bold;
        }

        .moon-phase {
            text-align: center;
            padding: 20px;
        }

        .moon-icon {
            font-size: 4em;
            margin: 15px 0;
        }

        .moon-label {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.1em;
        }

        .favorites-section {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .favorite-btn {
            padding: 10px 20px;
            background: rgba(255, 215, 0, 0.3);
            border: 2px solid rgba(255, 215, 0, 0.6);
            border-radius: 10px;
            color: white;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .favorite-btn:hover {
            background: rgba(255, 215, 0, 0.5);
        }

        .favorite-btn.active {
            background: rgba(255, 215, 0, 0.6);
        }

        .favorites-list {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .favorite-item {
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .favorite-item:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .remove-favorite {
            color: rgba(255, 100, 100, 0.8);
            font-weight: bold;
            margin-left: 5px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.5em;
            color: white;
            font-weight: bold;
        }

        .stat-label {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.85em;
            margin-top: 5px;
        }

        .footer {
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            margin-top: 30px;
            font-size: 0.95em;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2em;
            }

            .location-name {
                font-size: 1.8em;
            }

            .temp-display {
                font-size: 4em;
            }

            .weather-icon {
                font-size: 5em;
            }

            .search-container {
                flex-direction: column;
            }

            .two-column-layout {
                grid-template-columns: 1fr;
            }

            .forecast-grid {
                grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🌍 Global Weather Pro</h1>
            <div class="search-container">
                <input type="text" id="searchBox" class="search-box" placeholder="Search any city worldwide..." />
                <button class="btn" onclick="searchWeather()">Search</button>
                <button class="btn" onclick="getUserLocation()">📍 My Location</button>
            </div>
            <div class="settings-bar">
                <button class="toggle-btn active" id="celsiusBtn" onclick="setTempUnit('C')">°C</button>
                <button class="toggle-btn" id="fahrenheitBtn" onclick="setTempUnit('F')">°F</button>
                <button class="toggle-btn" onclick="toggleTheme()">🌓 Theme</button>
            </div>
            <div id="errorMessage" class="error-message"></div>
        </div>

        <div id="loading" class="loading">
            <div class="spinner"></div>
            <div>Loading weather data...</div>
        </div>

        <div id="weatherContent" class="weather-content">
            <div id="weatherAlerts" class="weather-alerts">
                <div class="alert-title">⚠️ Weather Alert</div>
                <div id="alertContent"></div>
            </div>

            <div class="favorites-section">
                <button class="favorite-btn" id="favoriteBtn" onclick="toggleFavorite()">⭐ Add to Favorites</button>
                <div class="favorites-list" id="favoritesList"></div>
            </div>

            <div class="current-weather">
                <div class="location-info">
                    <div>
                        <div class="location-name" id="locationName"></div>
                        <div class="location-country" id="locationCountry"></div>
                    </div>
                    <div class="current-date" id="currentDate"></div>
                </div>

                <div class="main-temp-container">
                    <div>
                        <div class="temp-display">
                            <span id="mainTemp"></span><span class="temp-unit" id="tempUnit">°C</span>
                        </div>
                        <div class="weather-description" id="weatherDesc"></div>
                        <div class="feels-like" id="feelsLike"></div>
                    </div>
                    <div class="weather-icon" id="mainIcon"></div>
                </div>
            </div>

            <div class="weather-details" id="weatherDetails"></div>

            <div class="two-column-layout">
                <div class="section-card">
                    <div class="section-title">24-Hour Forecast</div>
                    <div class="hourly-scroll" id="hourlyForecast"></div>
                </div>

                <div class="section-card">
                    <div class="section-title">Weather Stats</div>
                    <div class="stats-grid" id="weatherStats"></div>
                </div>
            </div>

            <div class="forecast-section">
                <div class="forecast-title">7-Day Forecast</div>
                <div class="forecast-grid" id="forecastGrid"></div>
            </div>

            <div class="two-column-layout">
                <div class="section-card">
                    <div class="section-title">Sun & Moon</div>
                    <div class="sun-times">
                        <div class="sun-time-item">
                            <div class="sun-time-icon">🌅</div>
                            <div class="sun-time-value" id="sunriseTime"></div>
                            <div class="stat-label">Sunrise</div>
                        </div>
                        <div class="sun-time-item">
                            <div class="sun-time-icon">🌇</div>
                            <div class="sun-time-value" id="sunsetTime"></div>
                            <div class="stat-label">Sunset</div>
                        </div>
                    </div>
                    <div class="moon-phase">
                        <div class="moon-icon" id="moonIcon">🌕</div>
                        <div class="moon-label" id="moonPhase">Full Moon</div>
                    </div>
                </div>

                <div class="section-card">
                    <div class="section-title">UV Index</div>
                    <div class="air-quality-card">
                        <div class="aqi-label">Current UV Level</div>
                        <div class="aqi-value" id="uvValue">--</div>
                        <div class="uv-index-bar">
                            <div class="uv-indicator" id="uvIndicator"></div>
                        </div>
                        <div class="stat-label" id="uvDescription" style="margin-top: 10px;"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>Powered by Open-Meteo API • Real-time weather data worldwide</p>
            <p style="margin-top: 10px; font-weight: bold;">All rights are reserved by VK</p>
        </div>
    </div>

    <script>
        let currentWeatherData = null;
        let currentLocation = null;
        let tempUnit = 'C';
        let favorites = JSON.parse(localStorage.getItem('weatherFavorites')) || [];

        const weatherDescriptions = {
            0: 'Clear sky', 1: 'Mainly clear', 2: 'Partly cloudy', 3: 'Overcast',
            45: 'Foggy', 48: 'Depositing rime fog', 51: 'Light drizzle',
            53: 'Moderate drizzle', 55: 'Dense drizzle', 61: 'Slight rain',
            63: 'Moderate rain', 65: 'Heavy rain', 71: 'Slight snow',
            73: 'Moderate snow', 75: 'Heavy snow', 80: 'Slight rain showers',
            81: 'Moderate rain showers', 82: 'Violent rain showers',
            85: 'Slight snow showers', 86: 'Heavy snow showers',
            95: 'Thunderstorm', 96: 'Thunderstorm with slight hail',
            99: 'Thunderstorm with heavy hail'
        };

        const weatherIcons = {
            0: '☀️', 1: '🌤️', 2: '⛅', 3: '☁️',
            45: '🌫️', 48: '🌫️', 51: '🌦️', 53: '🌦️', 55: '🌦️',
            61: '🌧️', 63: '🌧️', 65: '🌧️', 71: '🌨️', 73: '🌨️', 75: '🌨️',
            80: '🌦️', 81: '🌦️', 82: '⛈️', 85: '🌨️', 86: '🌨️',
            95: '⛈️', 96: '⛈️', 99: '⛈️'
        };

        document.getElementById('searchBox').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') searchWeather();
        });

        window.onload = function() {
            displayFavorites();
            getUserLocation();
        };

        function setTempUnit(unit) {
            tempUnit = unit;
            document.getElementById('celsiusBtn').classList.toggle('active', unit === 'C');
            document.getElementById('fahrenheitBtn').classList.toggle('active', unit === 'F');
            document.getElementById('tempUnit').textContent = '°' + unit;
            
            if (currentWeatherData) {
                updateTemperatureDisplay();
            }
        }

        function convertTemp(celsius) {
            if (tempUnit === 'F') {
                return Math.round(celsius * 9/5 + 32);
            }
            return Math.round(celsius);
        }

        function updateTemperatureDisplay() {
            if (!currentWeatherData) return;
            
            document.getElementById('mainTemp').textContent = convertTemp(currentWeatherData.current.temperature_2m);
            document.getElementById('feelsLike').textContent = `Feels like ${convertTemp(currentWeatherData.current.apparent_temperature)}°${tempUnit}`;
        }

        function toggleTheme() {
            const body = document.body;
            const currentGradient = body.style.background;
            
            if (currentGradient.includes('667eea')) {
                body.style.background = 'linear-gradient(135deg, #2c3e50 0%, #34495e 100%)';
            } else {
                body.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
            }
        }

        function toggleFavorite() {
            if (!currentLocation) return;
            
            const locationKey = `${currentLocation.name}, ${currentLocation.country}`;
            const index = favorites.findIndex(f => f.key === locationKey);
            
            if (index > -1) {
                favorites.splice(index, 1);
                document.getElementById('favoriteBtn').classList.remove('active');
                document.getElementById('favoriteBtn').textContent = '⭐ Add to Favorites';
            } else {
                favorites.push({
                    key: locationKey,
                    name: currentLocation.name,
                    country: currentLocation.country,
                    lat: currentLocation.latitude,
                    lon: currentLocation.longitude
                });
                document.getElementById('favoriteBtn').classList.add('active');
                document.getElementById('favoriteBtn').textContent = '⭐ Remove from Favorites';
            }
            
            localStorage.setItem('weatherFavorites', JSON.stringify(favorites));
            displayFavorites();
        }

        function displayFavorites() {
            const container = document.getElementById('favoritesList');
            if (favorites.length === 0) {
                container.innerHTML = '<div style="color: rgba(255,255,255,0.6);">No favorites added yet</div>';
                return;
            }
            
            container.innerHTML = favorites.map(fav => `
                <div class="favorite-item" onclick="loadFavorite(${fav.lat}, ${fav.lon})">
                    📍 ${fav.name}
                    <span class="remove-favorite" onclick="event.stopPropagation(); removeFavorite('${fav.key}')">×</span>
                </div>
            `).join('');
        }

        function removeFavorite(key) {
            favorites = favorites.filter(f => f.key !== key);
            localStorage.setItem('weatherFavorites', JSON.stringify(favorites));
            displayFavorites();
        }

        function loadFavorite(lat, lon) {
            fetchWeatherByCoords(lat, lon);
        }

        function showLoading() {
            document.getElementById('loading').style.display = 'block';
            document.getElementById('weatherContent').style.display = 'none';
            document.getElementById('errorMessage').style.display = 'none';
        }

        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
        }

        function showError(message) {
            const errorEl = document.getElementById('errorMessage');
            errorEl.textContent = message;
            errorEl.style.display = 'block';
            hideLoading();
        }

        function getUserLocation() {
            if (navigator.geolocation) {
                showLoading();
                navigator.geolocation.getCurrentPosition(
                    position => fetchWeatherByCoords(position.coords.latitude, position.coords.longitude),
                    error => {
                        showError('Unable to get your location. Please search for a city.');
                        hideLoading();
                    }
                );
            } else {
                showError('Geolocation is not supported by your browser.');
            }
        }

        async function fetchWeatherByCoords(lat, lon) {
            try {
                const weatherResponse = await fetch(
                    `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m,apparent_temperature,precipitation,weather_code,cloud_cover,wind_speed_10m,wind_direction_10m,pressure_msl&hourly=temperature_2m,weather_code,precipitation_probability&daily=weather_code,temperature_2m_max,temperature_2m_min,sunrise,sunset,precipitation_sum,precipitation_probability_max,uv_index_max&timezone=auto`
                );
                const weatherData = await weatherResponse.json();

                const geocodeResponse = await fetch(
                    `https://geocoding-api.open-meteo.com/v1/search